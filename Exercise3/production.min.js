var Main=function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){(function(b){function d(a){for(var b=document.getElementsByClassName("WindowClass"),c=0;c<b.length;c++)b[c].style.display=b[c].id==a?"block":"none";return"MainWindow"==a?(e("AppsFrame"),$("MB2").style.display=0==UserInfo.role?"inline":"none",void($("StatusBar").innerHTML=UserInfo.name+"("+UserInfo.login+")")):"RegWindow"==a?void g.Show():"LogonWindow"==a?void f.Show():void 0}function e(a){for(var b=document.getElementsByClassName("FrameClass"),c=0;c<b.length;c++)b[c].style.display=b[c].id==a?"block":"none";return"AppsFrame"==a?void i.ShowAppsFrame():(AlertMsg($("AppsFrameMsg"),""),AlertMsg($("DetailAppsFrameMsg"),""),"DetailAppsFrame"==a?void i.ShowDetailAppsFrame():"CreateAppsFrame"==a?void i.ShowCreateFrame():"UsersFrame"==a?void h.Show():void 0)}var f=(c(1),c(2)),g=c(3),h=c(4),i=c(5),j=$("LoginForm"),k=$("RegistrationForm"),l=$("AddEditUserForm"),m=$("NewAppForm");b.LoginForm=j,b.RegForm=k,b.AddNewUserForm=l,b.AddNewAppForm=m,d("LogonWindow"),f(),g(),h(),i(),$("MB1").addEventListener("click",function(){e("AppsFrame"),event.preventDefault()}),$("MB2").addEventListener("click",function(){e("UsersFrame"),event.preventDefault()}),b.SetWindow=d,b.SetFrame=e,a.exports.AppsModule=i}).call(b,function(){return this}())},function(a,b){(function(a){function b(a){return document.getElementById(a)}function c(a){return 0==a?"Администратор":1==a?"Исполнитель":2==a?"Клиент":void 0}function d(a){var b="",a=a||!1,c=new Date;return a&&c.setDate(c.getDate()+a),b=c.getFullYear()+"-"+(c.getMonth()+1).toString().lpad("0",2)+"-"+c.getDate().toString().lpad("0",2)+"T"+c.getHours().toString().lpad("0",2)+":"+c.getMinutes().toString().lpad("0",2)}function e(a){var b={login:a.login,pass:a.pass,role:a.role,name:a.name,lastsession:new Date};localStorage["admapp.users."+b.login.toLowerCase()]=JSON.stringify(b)}function f(a){return JSON.parse(localStorage["admapp.users."+a.toLowerCase()])}function g(a){return!!h(a)&&(localStorage.removeItem("admapp.users."+a.toLowerCase()),!0)}function h(a){return null!=localStorage["admapp.users."+a.toLowerCase()]}function i(a){var b=[];a=a||!1;for(var c=0;c<localStorage.length;c++)if(localStorage.key(c).indexOf("admapp.users.")+1)if(a){var d=JSON.parse(localStorage.getItem(localStorage.key(c)));d.role in a&&(b[c]=d)}else b[c]=JSON.parse(localStorage.getItem(localStorage.key(c)));return b}function j(a,b){return b==JSON.parse(localStorage["admapp.users."+a.toLowerCase()]).pass}function k(a){var b={ID:a.id,Name:a.name,Date:a.date,Client:a.client,Executor:a.executor,Discription:a.discription,Priority:a.priority,Estimated:a.estimated,Deadline:a.deadline,Progress:a.progress};localStorage["admapp.apps.id"+b.ID.toString()]=JSON.stringify(b)}function l(a){return n(a)?JSON.parse(localStorage["admapp.apps.id"+a]):null}function m(a){return!!n(a)&&(localStorage.removeItem("admapp.apps.id"+a),!0)}function n(a){return null!=localStorage["admapp.apps.id"+a]}function o(a){for(var b=[],c=0;c<localStorage.length;c++)if(localStorage.key(c).indexOf("admapp.apps.")+1)if(a.client||a.executor){var d=JSON.parse(localStorage.getItem(localStorage.key(c)));a.client&&a.client.toLowerCase()==d.Client.toLowerCase()&&(b[c]=d),a.executor&&a.executor.toLowerCase()==d.Executor.toLowerCase()&&(b[c]=d)}else b[c]=JSON.parse(localStorage.getItem(localStorage.key(c)));return b}function p(a){var b={ID:a.id,App:a.app,User:a.user,Date:a.date,Text:a.text};localStorage["admapp.comms.id"+b.ID.toString()]=JSON.stringify(b)}function q(a){return s(a)?JSON.parse(localStorage["admapp.comms.id"+a]):null}function r(a){return!!s(a)&&(localStorage.removeItem("admapp.comms.id"+a),!0)}function s(a){return null!=localStorage["admapp.comms.id"+a]}function t(){return 0==localStorage.length}function u(){if(localStorage["admapp.keys.apps"]){var a=parseInt(localStorage["admapp.keys.apps"]);return localStorage["admapp.keys.apps"]=a+1,a}return localStorage["admapp.keys.apps"]=1,0}function v(){if(localStorage["admapp.keys.comms"]){var a=parseInt(localStorage["admapp.keys.comms"]);return localStorage["admapp.keys.comms"]=a+1,a}return localStorage["admapp.keys.comms"]=1,0}function w(a,b){for(var c=a.getElementsByClassName("alert");c.length>0;)a.removeChild(c[0]);var d=document.createElement("div");d.className="alert",d.innerHTML=b,a.appendChild(d)}function x(a,b){var c=document.createElement("div");c.id="AppsList";var d="<table class='simple-little-table'  cellspacing='0'>";if(d+="<tr><th>Название</th><th>Дата</th>"+(2!=b.role?"<th>Клиент</th>":"")+(0==b.role?"<th>Исполнитель</th>":"")+"<th>Приоритет</th><th>Предельный срок</th>"+(2!=b.role?"<th>Предпологаемый срок</th>":"")+"<th>Завершено</th></tr>",0==a.length)return d+="<tr><td colspan='8' style='text-align:center;'>Нет заявок</td></tr></table>",c.innerHTML=d,c;for(var e in a)d+="<tr style='cursor:pointer;' onclick='Main.AppsModule.GetDetailInfo("+a[e].ID+")'><td>",d+=a[e].Name+"</td><td>",d+=new Date(Date.parse(a[e].Date)).toUTCString()+"</td><td>",2!=b.role&&(d+=(h(a[e].Client)?f(a[e].Client).name:"Client")+"</td><td>"),0==b.role&&(d+=(h(a[e].Executor)?f(a[e].Executor).name:"Нет")+"</td><td>"),d+=(0==a[e].Priority?"Низкий":1==a[e].Priority?"Средний":"Высокий")+"</td><td>",d+=new Date(Date.parse(a[e].Deadline)).toUTCString()+"</td><td>",2!=b.role&&(d+=new Date(Date.parse(a[e].Estimated)).toUTCString()+"</td><td>"),d+=a[e].Progress+"%</td></tr>";return d+="</table>",c.innerHTML=d,c}function y(a,c,d){var e=d*c,f=a.target,g=b(f.id+"Div");g.innerHTML=f.value;var h=g.offsetHeight;13==a.keyCode?h+=c:h<e&&(h=e),f.style.height=h+"px"}function z(a,b){if("login"==a){var c=/^[a-z][a-z0-9]*?([-_][a-z0-9]+){0,2}$/i;if(b.length>3&&c.test(b))return!0}if("pass"==a){var c=/^[a-zA-Z0-9]+$/;if(b.length>3&&c.test(b))return!0}if("name"==a){var c=/^[а-яА-ЯёЁa-zA-Z0-9]+$/;if(b.length>3&&b.length<51&&c.test(b))return!0}if("role"==a){var c=/^[0-9]+$/;if(1==b.length&&c.test(b))return!0}return!1}function A(a){return"login"==a?"Недопустимый логин. Логин должен содержать не менее 4х символов и начинаться с буквы латинского алфавита, заканчиваться буквой/цифрой. Может состоять из цифр и латинские букв, а также не более двух, не идущих подряд символов '-' и '_'.":"pass"==a?"Недопустимый пароль. Пароль должен содержать не менее 4х символов, состоять только из цифр и латинских букв.":"name"==a?"Недопустимое имя. Имя должно содержать не менее 3 и не более 50 символов. Состоять из букв и цифр.":"Недопустимое значение"}var B,C,D,E,F=[1,1,1],G=!1;a.UserInfo=B,a.UsersFilter=F,a.UsersList=C,a.CommsList=D,a.UserFilterOpened=G,a.TempAppID=E,String.prototype.lpad=function(a,b){for(var c=this;c.length<b;)c=a+c;return c},a.GetCommList=function(a){for(var b=[],c=0;c<localStorage.length;c++)if(localStorage.key(c).indexOf("admapp.comms.")+1){var d=JSON.parse(localStorage.getItem(localStorage.key(c)));d.App==a&&(b[c]=d)}return b},a.$=b,a.GetRoleFromCode=c,a.LocalDateTime=d,a.SaveUser=e,a.GetUser=f,a.DeleteUser=g,a.UserExist=h,a.GetUsersList=i,a.CheckPassword=j,a.SaveApp=k,a.GetApp=l,a.DeleteApp=m,a.AppExist=n,a.GetAppList=o,a.SaveComm=p,a.GetComm=q,a.DeleteComm=r,a.CommExist=s,a.StorageIsClear=t,a.GetNewAppsID=u,a.GetNewCommsID=v,a.AlertMsg=w,a.GetAppsListItem=x,a.TextAreaResize=y,a.ValidateValue=z,a.WrongValueMessage=A}).call(b,function(){return this}())},function(a,b,c){function d(){$("LoginForm").reset(),AlertMsg($("LoginForm"),"")}c(1);a.exports=function(){LoginForm||(LoginForm=$("LoginForm")),LoginForm.addEventListener("submit",function(a){a.preventDefault();var b={login:LoginForm.elements[1].value,pass:LoginForm.elements[2].value};return ValidateValue("login",b.login)?ValidateValue("pass",b.pass)?void(UserExist(b.login)?CheckPassword(b.login,b.pass)?(UserInfo=GetUser(b.login),SaveUser(UserInfo),SetWindow("MainWindow")):AlertMsg($("LoginForm"),"Неверный пароль!"):AlertMsg($("LoginForm"),"Пользователь не существует!")):void AlertMsg($("LoginForm"),WrongValueMessage("pass")):void AlertMsg($("LoginForm"),WrongValueMessage("login"))}),$("RegHref").addEventListener("click",function(){SetWindow("RegWindow"),event.preventDefault()}),$("RegHref").addEventListener("click",function(){SetWindow("RegWindow"),event.preventDefault()}),d()},a.exports.Show=d},function(a,b,c){var d=(c(1),c(2));a.exports=function(){RegForm||(RegForm=$("RegistrationForm")),RegForm.addEventListener("submit",function(a){a.preventDefault();var b={login:RegForm.elements[1].value,pass:RegForm.elements[2].value,name:RegForm.elements[3].value,role:StorageIsClear()?0:2};return ValidateValue("login",b.login)?ValidateValue("pass",b.pass)?ValidateValue("name",b.name)?UserExist(b.login)?void AlertMsg($("RegistrationForm"),"Логин занят!"):(SaveUser(b),d.Show,void AlertMsg($("LoginForm"),"<font color = 'green'>Успешная регистрация!</font>")):void AlertMsg($("RegistrationForm"),WrongValueMessage("name")):void AlertMsg($("RegistrationForm"),WrongValueMessage("pass")):void AlertMsg($("RegistrationForm"),WrongValueMessage("login"))})},a.exports.Show=function(){$("RegistrationForm").reset(),AlertMsg($("RegistrationForm"),"")}},function(a,b,c){function d(){UserFilterOpened="block"!=$("filter").style.display,$("filter").style.display=UserFilterOpened?"block":"none",$("ufilterdrop").innerHTML=UserFilterOpened?"Фильтр &#149;":"Фильтр ▼"}function e(){UsersFilter=[],$("ufilter1").checked&&(UsersFilter[0]=1),$("ufilter2").checked&&(UsersFilter[1]=1),$("ufilter3").checked&&(UsersFilter[2]=1),j()}function f(a){i(!1);var b="Логин: "+UsersList[a].login+" <button class='btn' id='DelUserBtn'>Удалить</button><br>Пароль: <input id='newpw' required type='text' value='"+UsersList[a].pass+"'><br> Роль: <select id='rlsl'><option value='2'"+(2==UsersList[a].role?"selected='selected'":"")+">Клиент</option><option value='1'"+(1==UsersList[a].role?"selected='selected'":"")+">Исполнитель</option><option value='0'"+(0==UsersList[a].role?"selected='selected'":"")+">Администратор</option></select><br>Имя: <input id='newnm' required type='text' value='"+UsersList[a].name+"'>";b+="<br><button class='btn' id='EditUserBtn'>Изменить</button>",$("UsersContentEdit").innerHTML=b,$("EditUserBtn").addEventListener("click",function(a){return function(){g(a)}}(a)),$("DelUserBtn").addEventListener("click",function(a){return function(){h(a)}}(a))}function g(a){var b={login:UsersList[a].login,pass:$("newpw").value,name:$("newnm").value,role:$("rlsl").value};return ValidateValue("pass",b.pass)?ValidateValue("name",b.name)?ValidateValue("role",b.role)?(SaveUser(b),UsersList[a]=b,$("UL"+a).innerHTML=UsersList[a].name,UsersList[a].role in UsersFilter||$("UL"+a).parentNode.removeChild($("UL"+a)),void AlertMsg($("UsersContentEdit"),"<font color = 'green'>Изменения сохранены!</font>")):void AlertMsg($("UsersContentEdit"),WrongValueMessage("")+": "+b.role):void AlertMsg($("UsersContentEdit"),WrongValueMessage("name")):void AlertMsg($("UsersContentEdit"),WrongValueMessage("pass"))}function h(a){confirm("Действительно удалить запись о пользователе "+UsersList[a].name+"("+UsersList[a].login+")?")&&DeleteUser(UsersList[a].login)&&($("UsersContentEdit").innerHTML="",$("UL"+a).remove())}function i(a){AddNewUserForm.style.display=a?"block":"none",$("UsersContentEdit").innerHTML="",AddNewUserForm.reset(),AlertMsg($("AddEditUserForm"),"")}function j(){$("MB1").style.backgroundColor="",$("MB2").style.backgroundColor="#d9dee2",UsersList=GetUsersList(UsersFilter);var a="<ul><li><a href='#' id='ufilterdrop' style='color:blue;'>"+(UserFilterOpened?"Фильтр &#149;":"Фильтр ▼")+"</a><div id='filter' style='display: "+(UserFilterOpened?"block":"none")+"; padding-left: 40px;'>Администраторы <input id='ufilter1' type='checkbox'><br>Исполнители<input id='ufilter2' type='checkbox'><br>Клиенты<input id='ufilter3' type='checkbox' ></div></li>";for(var b in UsersList)a+="<li><a href='#' id='UL"+b+"'>"+UsersList[b].name+"</a></li>";a+="</ul>",$("UsersMenu").innerHTML=a,$("ufilter1").checked=0 in UsersFilter?"checked":"",$("ufilter2").checked=1 in UsersFilter?"checked":"",$("ufilter3").checked=2 in UsersFilter?"checked":"",$("ufilter1").addEventListener("change",function(){e()}),$("ufilter2").addEventListener("change",function(){e()}),$("ufilter3").addEventListener("change",function(){e()}),$("ufilterdrop").addEventListener("click",function(){d()});for(var c in UsersList)$("UL"+c).addEventListener("click",function(a){return function(){f(a)}}(c));AddNewUserForm.style.display="none",$("UsersContentEdit").innerHTML=""}c(1);a.exports=function(){$("AddNewUserFormHref").addEventListener("click",function(){i(!0)}),AddNewUserForm||(AddNewUserForm=$("AddEditUserForm")),AddNewUserForm.style.display="none",AddNewUserForm.addEventListener("submit",function(a){a.preventDefault();var b={login:AddNewUserForm.elements[1].value,pass:AddNewUserForm.elements[2].value,name:AddNewUserForm.elements[3].value,role:AddNewUserForm.elements[4].value};return ValidateValue("login",b.login)?ValidateValue("pass",b.pass)?ValidateValue("name",b.name)?UserExist(b.login)?void AlertMsg($("AddEditUserForm"),"Пользователь с таким логином существует!"):(SaveUser(b),AlertMsg($("AddEditUserForm"),"<font color = 'green'>Пользователь создан!</font>"),void j()):void AlertMsg($("AddEditUserForm"),WrongValueMessage("name")):void AlertMsg($("AddEditUserForm"),WrongValueMessage("pass")):void AlertMsg($("AddEditUserForm"),WrongValueMessage("login"))})},a.exports.Show=j,a.exports.DropFilter=d,a.exports.UFilterChange=e,a.exports.SideUserMenuClick=f,a.exports.ChangeUserInfo=g,a.exports.DeleteUserFromList=h,a.exports.AddNewUserFormShow=i},function(a,b,c){function d(){if($("MB1").style.backgroundColor="#d9dee2",$("MB2").style.backgroundColor="",AddNewAppForm.reset(),AddNewAppForm.elements[2].value=LocalDateTime(),AddNewAppForm.elements[6].value=LocalDateTime(30),AddNewAppForm.elements[8].value=LocalDateTime(30),AddNewAppForm.elements[9].value="0",2==UserInfo.role&&(AddNewAppForm.elements[3].innerHTML="<option value='"+UserInfo.login.toLowerCase()+"' selected>"+UserInfo.name+"</option>",AddNewAppForm.elements[2].disabled="disabled",AddNewAppForm.elements[3].disabled="disabled",AddNewAppForm.elements[4].disabled="disabled",AddNewAppForm.elements[8].disabled="disabled",AddNewAppForm.elements[9].disabled="disabled",AddNewAppForm.elements[2].hidden="hidden",$("NewAppFormDTRow").hidden="hidden",$("NewAppFormCERow").hidden="hidden",$("NewAppFormDSRow").hidden="hidden"),!(UserInfo.role>0)){var a=GetUsersList([,,2]),b="";for(var c in a)b+="<option value='"+a[c].login.toLowerCase()+"'>"+a[c].name+"</option>";$("ClientSelect").innerHTML=b;var b="<option value='null'>-пусто-</option>",d=GetUsersList([,1]);for(var c in d)b+="<option value='"+d[c].login.toLowerCase()+"'>"+d[c].name+"</option>";$("ExecutorSelect").innerHTML=b}}function e(){if($("MB1").style.backgroundColor="#d9dee2",$("MB2").style.backgroundColor="",$("CommArea").value="",null!=$("DeleteAppsBtn")&&$("DeleteAppsBtn").remove(),null!=$("EditAppsBtn")&&$("EditAppsBtn").remove(),2!=UserInfo.role){var a=document.createElement("button");if(a.id="EditAppsBtn",a.className="btn",a.style="float:right;",a.innerHTML="Изменить",$("DetailFrameLabel").appendChild(a),$("EditAppsBtn").addEventListener("click",function(){h()}),1!=UserInfo.role){var a=document.createElement("button");a.id="DeleteAppsBtn",a.className="btn",a.style="float:right;",a.innerHTML="Удалить",$("DetailFrameLabel").appendChild(a),$("DeleteAppsBtn").addEventListener("click",function(){i()})}}}function f(){$("MB1").style.backgroundColor="#d9dee2",$("MB2").style.backgroundColor="";var a=[];1==UserInfo.role&&(a.executor=UserInfo.login),2==UserInfo.role&&(a.client=UserInfo.login);var b=GetAppList(a);null!=$("AppsList")&&$("AppsList").remove(),$("AppsFrame").appendChild(GetAppsListItem(b,UserInfo)),$("AddAppsBtn").style.display=1==UserInfo.role?"none":"inline-block"}function g(a){e(),SetFrame("DetailAppsFrame");var b=!!AppExist(a)&&GetApp(a);if(b){TempAppID=a,null!=$("AppsDetail")&&$("AppsDetail").remove();var c=document.createElement("div");c.id="AppsDetail";var d="<table class='simple-little-table' cellspacing='0'>";if(d+="<tr><td>Название:</td><td>"+b.Name+"</td></tr>",d+="<tr><td>Дата:</td><td>"+new Date(Date.parse(b.Date)).toUTCString()+"</td></tr>",d+="<tr><td>Клиент:</td><td>"+(UserExist(b.Client)?GetUser(b.Client).name:"Client")+"</td></tr>",d+="<tr><td>Исполнитель:</td><td>",UserInfo.role>0)d+=UserExist(b.Executor)?GetUser(b.Executor).name:"Executor";else{d+="<select id='editappexecut'><option value='null'>-пусто-</option>";var f=GetUsersList([,1]);for(var g in f)d+="<option value='"+f[g].login.toLowerCase()+(b.Executor.toLowerCase()==f[g].login.toLowerCase()?"' selected='selected'":"'")+">"+f[g].name+"</option>"}d+="</select></td></tr>",d+="<tr><td>Приоритет:</td><td>"+(0==b.Priority?"Низкий":1==b.Priority?"Средний":"Высокий")+"</td></tr>",d+="<tr><td>Предельный срок:</td><td>",d+=UserInfo.role>0?new Date(Date.parse(b.Deadline)).toUTCString()+"</td></tr>":'<input type="datetime-local" id="editappdeadline" value="'+b.Deadline+'"></td></tr>',d+="<tr><td>Предпологаемый срок:</td><td>",d+=2==UserInfo.role?new Date(Date.parse(b.Estimated)).toUTCString()+"</td></tr>":'<input type="datetime-local" id="editappestimated" value="'+b.Estimated+'"></td></tr>',d+=2==UserInfo.role?"<tr><td>Завершено:</td><td>"+b.Progress+"%</td></tr>":"<tr><td>Завершено:</td><td><input type='number' value='"+b.Progress+"' min='0' max='100' id='editappstatus'></input>%</td></tr>",d+="<tr><td colspan='2' style='vertical-align: top;'>Описание:<br>"+b.Discription+"</td></tr>",c.innerHTML=d+"</table>",$("DetailFrameTable").appendChild(c);var d="";CommsList=GetCommList(a);for(var g in CommsList)d+="<div id='CM"+CommsList[g].ID+"' class='Comms'><div class='CommsHeader'>",d+="<div class='CommsUser'>"+(UserExist(CommsList[g].User)?GetUser(CommsList[g].User).name:"User")+"</div>",d+="<div class='CommsTime'>"+new Date(Date.parse(CommsList[g].Date)).toUTCString()+"</div></div>",0!=UserInfo.role&&CommsList[g].User.toLowerCase()!=UserInfo.login.toLowerCase()||(d+="<button id='CMDelBtn"+a+"' class='btn' style='float: right;'onclick='Main.AppsModule.DeleteComment("+CommsList[g].ID+");' >Удалить</button>"),d+="<div class='CommsText'>"+CommsList[g].Text+"</div></div>";$("DetailFrameComments").innerHTML=d}}function h(){var a=GetApp(TempAppID),b={id:a.ID,name:a.Name,date:a.Date,client:a.Client,executor:0==UserInfo.role?$("editappexecut").value:a.Executor,discription:a.Discription,priority:a.Priority,estimated:$("editappestimated").value,deadline:0==UserInfo.role?$("editappdeadline").value:a.Deadline,progress:$("editappstatus").value};return b.priority<0||b.priority>2?void AlertMsg($("DetailAppsFrameMsg"),"Недопустимые данные: "+b.priority):b.progress<0||b.progress>100?void AlertMsg($("DetailAppsFrameMsg"),"Недопустимые данные: "+b.progress):(SaveApp(b),void AlertMsg($("DetailAppsFrameMsg"),"<font color = 'green'>Заявка изменена!</font>"))}function i(){confirm("Действительно удалить запись о заявке "+(AppExist(TempAppID)?GetApp(TempAppID).Name:"")+"?")&&DeleteApp(TempAppID)&&SetFrame("AppsFrame")}function j(){if(""!=$("CommArea").value.trim()){var a=$("CommArea").value.trim();if(a=a.replace(/<.*?/g,""),a!=$("CommArea").value.trim())return void alert("Скобки <> запрещенны!");var b={id:GetNewCommsID(),app:TempAppID,user:UserInfo.login,date:LocalDateTime(),text:a};SaveComm(b),$("CommArea").value="";var c=document.createElement("div");c.id="CM"+b.id,c.className="Comms";var d="<div class='CommsHeader'>";d+="<div class='CommsUser'>"+(UserExist(b.user)?GetUser(b.user).name:"User")+"</div>",d+="<div class='CommsTime'>"+new Date(Date.parse(b.date)).toUTCString()+"</div></div>",0!=UserInfo.role&&b.user.toLowerCase()!=UserInfo.login.toLowerCase()||(d+="<button class='btn' style='float: right;' onclick='Main.AppsModule.DeleteComment("+b.id+");' >Удалить</button>"),d+="<div class='CommsText'>"+b.text+"</div>",c.innerHTML=d,$("DetailFrameComments").appendChild(c)}}function k(a){DeleteComm(a)&&$("CM"+a).remove()}c(1);a.exports=function(){AddNewAppForm.addEventListener("submit",function(a){a.preventDefault();var b={id:GetNewAppsID(),name:AddNewAppForm.elements[1].value,date:AddNewAppForm.elements[2].value,client:AddNewAppForm.elements[3].value,executor:AddNewAppForm.elements[4].value,discription:AddNewAppForm.elements[5].value,priority:AddNewAppForm.elements[7].value,estimated:AddNewAppForm.elements[8].value,deadline:AddNewAppForm.elements[6].value,progress:AddNewAppForm.elements[9].value},c=b.name.trim();if(c=c.replace(/<.*?/g,""),c!=b.name.trim())return void AlertMsg($("NewAppForm"),"Скобки <> запрещенны!");if(!c.length)return void AlertMsg($("NewAppForm"),"Пустое значение названия.");var c=b.discription.trim();return c=c.replace(/<.*?/g,""),c!=b.discription.trim()?void AlertMsg($("NewAppForm"),"Скобки <> запрещенны!"):c.length?UserExist(b.client)?b.priority<0||b.priority>2?void AlertMsg($("NewAppForm"),"Недопустимые данные: "+b.priority):(SaveApp(b),AlertMsg($("AppsFrameMsg"),"<font color = 'green'>Заявка создана!</font>"),void SetFrame("AppsFrame")):void AlertMsg($("NewAppForm"),"Недопустимые данные: "+b.client):void AlertMsg($("NewAppForm"),"Пустое значение описания.")})},a.exports.AddComment=j,a.exports.DeleteComment=k,a.exports.DeleteAppsFromDetail=i,a.exports.EditAppsFromDetail=h,a.exports.GetDetailInfo=g,a.exports.ShowDetailAppsFrame=e,a.exports.ShowCreateFrame=d,a.exports.ShowAppsFrame=f}]);